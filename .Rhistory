population <- fread("data/josh.csv")
eng_speaking_countries <- fread("data/eng_speaking.csv")
# Contains .csv with only non-english speaking countries
non_eng_native <- select(filter(eng_speaking_countries, V3 == 1), V1, V2)
######## Sub population 1 ########
# Immigrants who have learned english since moving to the US in the last 12 months WITH CHILD
sub_pop_1 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 1)
pop_children <- na.omit(as.numeric(sub_pop_1$ENG))
# Immigrants who have learned english since moving to the US in the last 12 months WITHOUT CHILD
sub_pop_2 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 2)
pop_no_children <- na.omit(as.numeric(sub_pop_2$ENG))
result <- list(pop_no_children, pop_children)
return(result)
}
tester <- prepare_data()
View(tester)
View(tester$pop_no_children)
dim(tester)
prepare_data <- function(){
#### Gathering data ####
population <- fread("data/josh.csv")
eng_speaking_countries <- fread("data/eng_speaking.csv")
# Contains .csv with only non-english speaking countries
non_eng_native <- select(filter(eng_speaking_countries, V3 == 1), V1, V2)
######## Sub population 1 ########
# Immigrants who have learned english since moving to the US in the last 12 months WITH CHILD
sub_pop_1 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 1)
pop_children <- na.omit(as.numeric(sub_pop_1$ENG))
# Immigrants who have learned english since moving to the US in the last 12 months WITHOUT CHILD
sub_pop_2 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 2)
pop_no_children <- na.omit(as.numeric(sub_pop_2$ENG))
return(list(pop_no_children, pop_children))
}
list[a,b] <- prepare_data()
list[pop_no_children, pop_children] <- prepare_data()
prepare_data <- function(){
#### Gathering data ####
population <- fread("data/josh.csv")
eng_speaking_countries <- fread("data/eng_speaking.csv")
# Contains .csv with only non-english speaking countries
non_eng_native <- select(filter(eng_speaking_countries, V3 == 1), V1, V2)
######## Sub population 1 ########
# Immigrants who have learned english since moving to the US in the last 12 months WITH CHILD
sub_pop_1 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 1)
pop_children <- na.omit(as.numeric(sub_pop_1$ENG))
# Immigrants who have learned english since moving to the US in the last 12 months WITHOUT CHILD
sub_pop_2 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 2)
pop_no_children <- na.omit(as.numeric(sub_pop_2$ENG))
pops <- list("children" = pop_children, "nochildren" = pop_no_children)
return(pops)
}
tester <- prepare_data()
tester$children
tester$nochildren
prepare_data <- function(){
#### Gathering data ####
population <- fread("data/josh.csv")
eng_speaking_countries <- fread("data/eng_speaking.csv")
# Contains .csv with only non-english speaking countries
non_eng_native <- select(filter(eng_speaking_countries, V3 == 1), V1, V2)
######## Sub population 1 ########
# Immigrants who have learned english since moving to the US in the last 12 months WITH CHILD
sub_pop_1 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 1)
pop_children <- na.omit(as.numeric(sub_pop_1$ENG))
# Immigrants who have learned english since moving to the US in the last 12 months WITHOUT CHILD
sub_pop_2 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 2)
pop_no_children <- na.omit(as.numeric(sub_pop_2$ENG))
pops <- list("children" = pop_children, "nochildren" = pop_no_children)
return(pops)
}
had_child_t_test <- function(pops){
######## T - test ########
t.test(pops$children, pops$nochildren)
}
source("lib/jmd2228_functions.R")
population <- preparedata()
population <- prepare_data()
had_child_t_test(population)
had_child_bar_chart <- function(pops){
# Graph stacked bar charts
plotframe <- data.frame(ability = c("Very Well", "Well", "Not Well", "Not at all"), child = c(prop.table(table(pops$children))), nochild = c(prop.table(table(pops$nochildren))))
# Plot bar chart
chart <- gvisColumnChart(plotframe, xvar="ability", yvar=c("child", "nochild"), options=list(isStacked=TRUE, title="Parents' Ability to Speak English Stacked By Birth of Child", vAxes="[{title:'Percent of Sub Population'}]", series="[{labelInLegend: 'Child'}, {labelInLegend: 'No child'}]"))
plot(chart)
}
had_child_bar_chart()
source("lib/jmd2228_functions.R")
had_child_bar_chart(population)
prepare_data <- function(){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
return(notnative.noteng)
}
states <- function(population){
notnative.noteng <- population
##In What States Do Immigrants from Non-English Speaking Countries Live?
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
png("figs/sri2116_states.png")
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
dev.off()
# MIGHT NEED TO CALL DEV ON
}
prepare_data <- function(){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
return(notnative.noteng)
}
states <- function(population){
notnative.noteng <- population
##In What States Do Immigrants from Non-English Speaking Countries Live?
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
png("figs/sri2116_states.png")
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
dev.off()
# MIGHT NEED TO CALL DEV ON
}
source("lib/sri2116_functions.R")
population <- prepare_data()
states(population)
states(population)
dev.new()
states(population)
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
dev.new()
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
source("lib/sri2116_functions.R")
population <- prepare_data()
cols <- c("NATIVITY", "ST", "POBP", "MIG", "ENG", "FER", "MAR", "MARHD", "MARHM", "MARHW", "SEX", "NOP", "AGEP", "PWGTP")
cols <- c("NATIVITY", "POBP", "MIG", "ENG", "FER", "MAR", "NOP", "AGEP")
population <- fread("data/complete.csv", select = cols)
population <- fread("../data/complete.csv", select = cols)
getwd()
cols <- c("NATIVITY", "POBP", "MIG", "ENG", "FER", "MAR", "NOP", "AGEP")
population <- fread("data/complete.csv", select = cols)
cols <- c("NATIVITY", "POBP", "MIG", "ENG", "FER", "NOP", "AGEP")
population <- fread("data/complete.csv", select = cols)
write.csv("data/josh.csv")
write.csv(population, "data/josh.csv")
cols <- c("NATIVITY", "POBP", "MIG", "ENG", "FER")
cols2 <- c("NATIVITY", "ENG", "NOP", "AGEP")
population <- fread("data/complete.csv", select = cols)
write.csv(population, "data/josh1.csv")
population <- fread("data/complete.csv", select = cols2)
write.csv(population, "data/josh2.csv")
prepare_data <- function(){
#### Gathering data ####
population <- fread("data/josh1.csv")
eng_speaking_countries <- fread("data/eng_speaking.csv")
# Contains .csv with only non-english speaking countries
non_eng_native <- select(filter(eng_speaking_countries, V3 == 1), V1, V2)
######## Sub population 1 ########
# Immigrants who have learned english since moving to the US in the last 12 months WITH CHILD
sub_pop_1 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 1)
pop_children <- na.omit(as.numeric(sub_pop_1$ENG))
# Immigrants who have learned english since moving to the US in the last 12 months WITHOUT CHILD
sub_pop_2 <- filter(population, NATIVITY == 2 & MIG == 2 & POBP %in% non_eng_native$V1 & FER == 2)
pop_no_children <- na.omit(as.numeric(sub_pop_2$ENG))
pops <- list("children" = pop_children, "nochildren" = pop_no_children)
return(pops)
}
had_child_t_test <- function(pops){
######## T - test ########
t.test(pops$children, pops$nochildren)
}
had_child_bar_chart <- function(pops){
# Graph stacked bar charts
plotframe <- data.frame(ability = c("Very Well", "Well", "Not Well", "Not at all"), child = c(prop.table(table(pops$children))), nochild = c(prop.table(table(pops$nochildren))))
# Plot bar chart
chart <- gvisColumnChart(plotframe, xvar="ability", yvar=c("child", "nochild"), options=list(isStacked=TRUE, title="Parents' Ability to Speak English Stacked By Birth of Child", vAxes="[{title:'Percent of Sub Population'}]", series="[{labelInLegend: 'Child'}, {labelInLegend: 'No child'}]"))
plot(chart)
}
childs_parents_nativity <- function(){
#### Gathering data ####
population <- fread("data/josh2.csv")
#eng_speaking_countries <- fread("data/eng_speaking.csv")
# Children's ability to speak english
sub_pop_3 <- select(population, ENG, NOP, NATIVITY, AGEP)
sub_pop_3 <- subset(sub_pop_3, NATIVITY == 1 & AGEP <= 18)
sub_pop_3 <- select(sub_pop_3, ENG, NOP)
childframe <- data.frame(id = as.numeric(sub_pop_3$ENG), parent = as.numeric(sub_pop_3$NOP), childsize = c(rep(1,length(sub_pop_3$ENG))), fac = as.numeric(sub_pop_3$ENG))
childframe <- na.omit(childframe)
childframe <- aggregate(childframe$childsize, by=list(childframe$parent, childframe$id), sum)
childframe <- data.frame(id = childframe$Group.2, parent = childframe$Group.1, childsize = childframe$x, fac = childframe$x)
for(i in 1:dim(childframe)[1]){
if (childframe$parent[i] == 1){
childframe$parent[i] = "Both Native"
} else if (childframe$parent[i] == 2){
childframe$parent[i] = "Father Foreign"
} else if (childframe$parent[i] == 3){
childframe$parent[i] = "Mother Foreign"
} else if (childframe$parent[i] == 4){
childframe$parent[i] = "Both Foreign"
} else if (childframe$parent[i] == 5){
childframe$parent[i] = "Only Father, Native"
} else if (childframe$parent[i] == 6){
childframe$parent[i] = "Only Father, Foreign"
} else if (childframe$parent[i] == 7){
childframe$parent[i] = "Only Mother, Native"
} else {
childframe$parent[i] = "Only Mother, Foreign"
}
if (childframe$id[i] == 1){
childframe$id[i] = paste("Very Well Count:", childframe$childsize[i])
} else if (childframe$id[i] == 2){
childframe$id[i] = paste("Well Count:", childframe$childsize[i])
} else if (childframe$id[i] == 3){
childframe$id[i] = paste("Not well Count:", childframe$childsize[i])
} else {
childframe$id[i] = paste("Not at all Count:", childframe$childsize[i])
}
}
# Analysis Population 2
childframe <- rbind(c("TOP",NA,10, 2), childframe)
childframe <- rbind(c("Both Native","TOP",5, 4), childframe)
childframe <- rbind(c("Father Foreign","TOP",5, 5), childframe)
childframe <- rbind(c("Mother Foreign","TOP",5, 6), childframe)
childframe <- rbind(c("Both Foreign","TOP",5, 7), childframe)
childframe <- rbind(c("Only Father, Native","TOP",5, 8), childframe)
childframe <- rbind(c("Only Father, Foreign","TOP",5, 9), childframe)
childframe <- rbind(c("Only Mother, Native","TOP",5, 10), childframe)
childframe <- rbind(c("Only Mother, Foreign","TOP",5, 11), childframe)
childframe$id[36] = "Not at all Count: 9"
tree <- gvisTreeMap(childframe,  idvar="id", parentvar="parent", sizevar="childsize", colorvar="fac", options=list(minColor='#EDF8FB',midColor='#66C2A4',maxColor='#006D2C'))
plot(tree)
}
source("lib/jmd2228_functions.R")
population <- prepare_data()
had_child_t_test(population)
had_child_bar_chart(population)
childsparentsnativity()
childs_parents_nativity()
prepare_data <- function(){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
return(notnative.noteng)
}
states <- function(population){
notnative.noteng <- population
##In What States Do Immigrants from Non-English Speaking Countries Live?
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
#png("figs/sri2116_states.png")
#ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
#dev.off()
# MIGHT NEED TO CALL DEV ON
}
popular_languages <- function(population){
notnative.noteng <- population
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
levels(notnative.noteng$LANP)
levels(notnative.noteng$LANP) <- c("Jamaican Creole","Krio","German","Yiddish","Dutch","Afrikaans","Swedish","Danish","Norwegian","Italian","French","Patois","French Creole","Spanish","Portuguese","Romanian","Irish Gaelic","Greek","Albanian","Russian","Ukrainian","Czech","Polish","Slovak","Bulgarian","Macedonian","Serbo-Croatian","Croatian","Serbian","Lithuanian","Latvian","Armenian","Persian","Pashto","Kurdish","India N.E.C.","Hindi","Bengali","Panjabi","Marathi","Gujarati","Urdu","Nepali","Sindhi","Pakistan N.E.C.","Sinhalese","Finnish","Hungarian","Uighur","Turkish","Mongolian","Telugu","Kannada","Malayalam","Tamil","Chinese","Cantonese","Mandarin","Formosan","Burmese","Thai","Mien","Hmong","Japanese","Korean","Laotian","Mon-Khmer, Cambodian","Vietnamese","Indonesian","Malay","Tagalog","Bisayan","Sebuano","Ilocano","Micronesian","Chamorro","Trukese","Samoan","Tongan","Hawaiian","Arabic","Hebrew","Syriac","Amharic","Cushite","Swahili","Bantu","Mande","Fulani","Kru, Ibo, Yoruba","African","Other Algonquian languages","Ojibwa","Dakota","Keres","Cherokee","Zuni","Other Indo-European languages","Other Asian languages","Other Pacific Island languages","Other specified African languages","Aleut-Eskimo languages","South/Central American Indian languages","Other Specified North American Indian languages","Other languages")
LanguageCorpus <- paste(unlist(notnative.noteng$LANP), collapse =" ")
wordcloud(LanguageCorpus, scale=c(6,.5), max.words = 1000, random.order = FALSE, random.color = TRUE, colors = "red", ordered.colors = TRUE)
}
popular_languages(population)
states <- read.csv("data/statenames.csv")
states <- read.csv("data/statenames.csv")
getwd()
setwd("Documents/Spring 2016/DataScience/Project1/git_project3/cycle1-10/")
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
population <-notnative.noteng
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
dev.new()
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
dev.off()
dev.new()
dev.off()
dev.off()
dev.new()
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
levels(notnative.noteng$LANP)
levels(notnative.noteng$LANP) <- c("Jamaican Creole","Krio","German","Yiddish","Dutch","Afrikaans","Swedish","Danish","Norwegian","Italian","French","Patois","French Creole","Spanish","Portuguese","Romanian","Irish Gaelic","Greek","Albanian","Russian","Ukrainian","Czech","Polish","Slovak","Bulgarian","Macedonian","Serbo-Croatian","Croatian","Serbian","Lithuanian","Latvian","Armenian","Persian","Pashto","Kurdish","India N.E.C.","Hindi","Bengali","Panjabi","Marathi","Gujarati","Urdu","Nepali","Sindhi","Pakistan N.E.C.","Sinhalese","Finnish","Hungarian","Uighur","Turkish","Mongolian","Telugu","Kannada","Malayalam","Tamil","Chinese","Cantonese","Mandarin","Formosan","Burmese","Thai","Mien","Hmong","Japanese","Korean","Laotian","Mon-Khmer, Cambodian","Vietnamese","Indonesian","Malay","Tagalog","Bisayan","Sebuano","Ilocano","Micronesian","Chamorro","Trukese","Samoan","Tongan","Hawaiian","Arabic","Hebrew","Syriac","Amharic","Cushite","Swahili","Bantu","Mande","Fulani","Kru, Ibo, Yoruba","African","Other Algonquian languages","Ojibwa","Dakota","Keres","Cherokee","Zuni","Other Indo-European languages","Other Asian languages","Other Pacific Island languages","Other specified African languages","Aleut-Eskimo languages","South/Central American Indian languages","Other Specified North American Indian languages","Other languages")
View(population)
notnative.noteng <- na.omit(notnative.noteng)
View(notnative.noteng)
notnative.noteng <- na.omit(notnative.noteng)
View(notnative.noteng)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
notnative.noteng$LANP
notnative.noteng$LANP <- as.numeric(notnative.noteng$LANP)
notnative.noteng$LANP
notnative.noteng <- na.omit(notnative.noteng)
notnative.noteng$LANP
prepare_data <- function(){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
return(notnative.noteng)
}
notnative.noteng <- prepare_data()
View(notnative.noteng)
test <- <- as.factor(notnative.noteng$LANP)
test <- as.factor(notnative.noteng$LANP)
View(test)
levels(notnative.noteng$LANP)
levels(notnative.noteng$LANP)
View(levels(notnative.noteng$LANP))
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
notnative2 <- notnative
notnative$rENG <- 5-notnative$ENG
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
View(notnative.noteng)
class(notnative2)
notnative2 <- as.data.table(notnative2)
class(notnative2)
notnative2$rENG <- 5-notnative2$ENG
notnative.noteng <- as.data.table(notnative.noteng)
class(notnative.noteng)
View(notnative.noteng)
notnative.noteng <- na.omit(notnative.noteng)
View(notnative.noteng)
notnative.noteng <- population
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
View(notnative.noteng$LANP)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
View(notnative.noteng$LANP)
levels(notnative.noteng$LANP)
class(notnative.noteng$LANP)
notnative.noteng$LANP[0]
notnative.noteng$LANP[[0]]
notnative.noteng$LANP$x
View( notnative.noteng$LANP)
notnative.noteng[notnative.noteng!=""]
View(notnative.noteng$LANP)
View(notnative.noteng$LANP[notnative.noteng$LANP!=""])
levels(notnative.noteng$LANP[notnative.noteng$LANP!=""])
levels(notnative.noteng$LANP[notnative.noteng$LANP!="" & notnative.noteng$LANP!="LANP"])
levels(notnative.noteng$LANP[notnative.noteng$LANP!="" && notnative.noteng$LANP!="LANP"])
levels(notnative.noteng$LANP[notnative.noteng$LANP!="" and notnative.noteng$LANP!="LANP"])
levels(notnative.noteng$LANP[notnative.noteng$LANP!="" AND notnative.noteng$LANP!="LANP"])
levels(notnative.noteng$LANP[notnative.noteng$LANP!=""])
View(levels(notnative.noteng$LANP[notnative.noteng$LANP!=""]))
prepare_data <- function(){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$ENG <- as.integer(notnative$ENG)
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
return(notnative.noteng)
}
states <- function(population){
notnative.noteng <- population
##In What States Do Immigrants from Non-English Speaking Countries Live?
ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
#png("figs/sri2116_states.png")
#ggplot(notnative.noteng) + geom_bar(aes(x=name), color= "black", fill="indianred") + coord_flip() + theme(axis.text.y=element_text(size=rel(0.8))) + xlab("U.S. State") + ylab("Number of Respondents") + ggtitle("In What States Do Immigrants from Non-English Speaking Countries Live?")
#dev.off()
# MIGHT NEED TO CALL DEV ON
}
popular_languages <- function(population){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
#Reverse coding the ENG variable so that as score increases, it reflects greater ability to speak English
notnative$rENG <- 5-notnative$ENG
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
View(levels(notnative.noteng$LANP))
levels(notnative.noteng$LANP) <- c("Jamaican Creole","Krio","German","Yiddish","Dutch","Afrikaans","Swedish","Danish","Norwegian","Italian","French","Patois","French Creole","Spanish","Portuguese","Romanian","Irish Gaelic","Greek","Albanian","Russian","Ukrainian","Czech","Polish","Slovak","Bulgarian","Macedonian","Serbo-Croatian","Croatian","Serbian","Lithuanian","Latvian","Armenian","Persian","Pashto","Kurdish","India N.E.C.","Hindi","Bengali","Panjabi","Marathi","Gujarati","Urdu","Nepali","Sindhi","Pakistan N.E.C.","Sinhalese","Finnish","Hungarian","Uighur","Turkish","Mongolian","Telugu","Kannada","Malayalam","Tamil","Chinese","Cantonese","Mandarin","Formosan","Burmese","Thai","Mien","Hmong","Japanese","Korean","Laotian","Mon-Khmer, Cambodian","Vietnamese","Indonesian","Malay","Tagalog","Bisayan","Sebuano","Ilocano","Micronesian","Chamorro","Trukese","Samoan","Tongan","Hawaiian","Arabic","Hebrew","Syriac","Amharic","Cushite","Swahili","Bantu","Mande","Fulani","Kru, Ibo, Yoruba","African","Other Algonquian languages","Ojibwa","Dakota","Keres","Cherokee","Zuni","Other Indo-European languages","Other Asian languages","Other Pacific Island languages","Other specified African languages","Aleut-Eskimo languages","South/Central American Indian languages","Other Specified North American Indian languages","Other languages")
LanguageCorpus <- paste(unlist(notnative.noteng$LANP), collapse =" ")
wordcloud(LanguageCorpus, scale=c(6,.5), max.words = 1000, random.order = FALSE, random.color = TRUE, colors = "red", ordered.colors = TRUE)
}
popular_languages()
popular_languages()
popular_languages <- function(population){
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng <- na.omit(notnative.noteng)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
#View(levels(notnative.noteng$LANP))
levels(notnative.noteng$LANP) <- c("Jamaican Creole","Krio","German","Yiddish","Dutch","Afrikaans","Swedish","Danish","Norwegian","Italian","French","Patois","French Creole","Spanish","Portuguese","Romanian","Irish Gaelic","Greek","Albanian","Russian","Ukrainian","Czech","Polish","Slovak","Bulgarian","Macedonian","Serbo-Croatian","Croatian","Serbian","Lithuanian","Latvian","Armenian","Persian","Pashto","Kurdish","India N.E.C.","Hindi","Bengali","Panjabi","Marathi","Gujarati","Urdu","Nepali","Sindhi","Pakistan N.E.C.","Sinhalese","Finnish","Hungarian","Uighur","Turkish","Mongolian","Telugu","Kannada","Malayalam","Tamil","Chinese","Cantonese","Mandarin","Formosan","Burmese","Thai","Mien","Hmong","Japanese","Korean","Laotian","Mon-Khmer, Cambodian","Vietnamese","Indonesian","Malay","Tagalog","Bisayan","Sebuano","Ilocano","Micronesian","Chamorro","Trukese","Samoan","Tongan","Hawaiian","Arabic","Hebrew","Syriac","Amharic","Cushite","Swahili","Bantu","Mande","Fulani","Kru, Ibo, Yoruba","African","Other Algonquian languages","Ojibwa","Dakota","Keres","Cherokee","Zuni","Other Indo-European languages","Other Asian languages","Other Pacific Island languages","Other specified African languages","Aleut-Eskimo languages","South/Central American Indian languages","Other Specified North American Indian languages","Other languages")
LanguageCorpus <- paste(unlist(notnative.noteng$LANP), collapse =" ")
wordcloud(LanguageCorpus, scale=c(6,.5), max.words = 1000, random.order = FALSE, random.color = TRUE, colors = "red", ordered.colors = TRUE)
}
source("lib/sri2116_functions.R")
popular_languages()
states <- read.csv("data/statenames.csv")
subdata <- read.csv("data/schinria.csv")
states <- rename(states, c("code"="ST"))
alldata <- merge(subdata,states,by="ST") #merging state name file with ACS data
#Filtering data only to those who are non-native to US & those whose native country doesn't have English as primary or official language
notnative <- subset(alldata, NATIVITY==2)
rm(alldata)
rm(subdata)
notnative$notenglish <- ifelse((notnative$POBP==100|notnative$POBP==102|notnative$POBP==103|notnative$POBP==104|notnative$POBP==105|notnative$POBP==106|notnative$POBP==108|notnative$POBP==109|notnative$POBP==110|notnative$POBP==116|notnative$POBP==117|notnative$POBP==118|notnative$POBP==120|notnative$POBP==126|notnative$POBP==127|notnative$POBP==128|notnative$POBP==129|notnative$POBP==130|notnative$POBP==132|notnative$POBP==134|notnative$POBP==136|notnative$POBP==137|notnative$POBP==140|notnative$POBP==147|notnative$POBP==148|notnative$POBP==149|notnative$POBP==150|notnative$POBP==151|notnative$POBP==152|notnative$POBP==154|notnative$POBP==156|notnative$POBP==157|notnative$POBP==158|notnative$POBP==159|notnative$POBP==160|notnative$POBP==161|notnative$POBP==162|notnative$POBP==163|notnative$POBP==164|notnative$POBP==165|notnative$POBP==168|notnative$POBP==200|notnative$POBP==202|notnative$POBP==203|notnative$POBP==205|notnative$POBP==206|notnative$POBP==207|notnative$POBP==208|notnative$POBP==210|notnative$POBP==211|notnative$POBP==212|notnative$POBP==213|notnative$POBP==214|notnative$POBP==215|notnative$POBP==216|notnative$POBP==217|notnative$POBP==218|notnative$POBP==222|notnative$POBP==223|notnative$POBP==224|notnative$POBP==226|notnative$POBP==229|notnative$POBP==231|notnative$POBP==233|notnative$POBP==235|notnative$POBP==238|notnative$POBP==239|notnative$POBP==240|notnative$POBP==242|notnative$POBP==243|notnative$POBP==245|notnative$POBP==246|notnative$POBP==247|notnative$POBP==248|notnative$POBP==249|notnative$POBP==253|notnative$POBP==303|notnative$POBP==311|notnative$POBP==312|notnative$POBP==313|notnative$POBP==314|notnative$POBP==315|notnative$POBP==316|notnative$POBP==327|notnative$POBP==329|notnative$POBP==332|notnative$POBP==339|notnative$POBP==343|notnative$POBP==360|notnative$POBP==361|notnative$POBP==362|notnative$POBP==363|notnative$POBP==364|notnative$POBP==365|notnative$POBP==369|notnative$POBP==370|notnative$POBP==372|notnative$POBP==373|notnative$POBP==374|notnative$POBP==400|notnative$POBP==407|notnative$POBP==408|notnative$POBP==412|notnative$POBP==414|notnative$POBP==416|notnative$POBP==417|notnative$POBP==420|notnative$POBP==423|notnative$POBP==429|notnative$POBP==430|notnative$POBP==436|notnative$POBP==444|notnative$POBP==447|notnative$POBP==448|notnative$POBP==449|notnative$POBP==451|notnative$POBP==453|notnative$POBP==454|notnative$POBP==459|notnative$POBP==460|notnative$POBP==508|notnative$POBP==511|notnative$POBP==512|notnative$POBP==523|notnative$POBP==527),1,0)
notnative.noteng <- filter(notnative, notenglish == 1) # POBP: birthplace does not have primary or official language of English
notnative.noteng2 <- notnative.noteng
notnative.noteng <- na.omit(notnative.noteng)
View(notnative.noteng)
class(notnative.noteng)
notnative.noteng <- na.omit(as.data.table(notnative.noteng))
View(notnative.noteng)
empty_as_na <- function(x) ifelse(x=="", NA, x)
## transform all columns
notnative.noteng %<>% mutate_each(funs(empty_as_na))
notnative.noteng %>% mutate_each(funs(empty_as_na))
View(notnative.noteng)
notnative.noteng[notnative.noteng!=""] <- NA
View(notnative.noteng)
notnative.noteng <- notnative.noteng2
notnative.noteng[notnative.noteng==""] <- NA
View(notnative.noteng)
notnative.noteng <- na.omit(notnative.noteng)
View(notnative.noteng)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
#View(levels(notnative.noteng$LANP))
levels(notnative.noteng$LANP) <- c("Jamaican Creole","Krio","German","Yiddish","Dutch","Afrikaans","Swedish","Danish","Norwegian","Italian","French","Patois","French Creole","Spanish","Portuguese","Romanian","Irish Gaelic","Greek","Albanian","Russian","Ukrainian","Czech","Polish","Slovak","Bulgarian","Macedonian","Serbo-Croatian","Croatian","Serbian","Lithuanian","Latvian","Armenian","Persian","Pashto","Kurdish","India N.E.C.","Hindi","Bengali","Panjabi","Marathi","Gujarati","Urdu","Nepali","Sindhi","Pakistan N.E.C.","Sinhalese","Finnish","Hungarian","Uighur","Turkish","Mongolian","Telugu","Kannada","Malayalam","Tamil","Chinese","Cantonese","Mandarin","Formosan","Burmese","Thai","Mien","Hmong","Japanese","Korean","Laotian","Mon-Khmer, Cambodian","Vietnamese","Indonesian","Malay","Tagalog","Bisayan","Sebuano","Ilocano","Micronesian","Chamorro","Trukese","Samoan","Tongan","Hawaiian","Arabic","Hebrew","Syriac","Amharic","Cushite","Swahili","Bantu","Mande","Fulani","Kru, Ibo, Yoruba","African","Other Algonquian languages","Ojibwa","Dakota","Keres","Cherokee","Zuni","Other Indo-European languages","Other Asian languages","Other Pacific Island languages","Other specified African languages","Aleut-Eskimo languages","South/Central American Indian languages","Other Specified North American Indian languages","Other languages")
View(notnative.noteng$LANP)
View(levels(notnative.noteng$LANP))
notnative.noteng[notnative.noteng==""] <- NA
notnative.noteng <- na.omit(notnative.noteng)
levels(notnative.noteng)
notnative.noteng$LANP <- as.factor(notnative.noteng$LANP)
View(levels(notnative.noteng$LANP))
View(notnative.noteng)
View(notnative.noteng$LANP)
View(notnative.noteng$LANP[""])
View(notnative.noteng$LANP["LANP"])
